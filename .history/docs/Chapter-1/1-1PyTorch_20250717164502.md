
### PyTorch环境搭建(Windows版本)

首先检查自己的电脑有无nvidia的显卡，如果电脑上没有显卡，就配置CPU版的PyTorch，参考**步骤1,4**，如果自己电脑上有相关GPU，就安装GPU版的PyTorch，参考**步骤1,2,3**。

## 步骤1: Anaconda安装

Anaconda是python包的管理器，可以帮助我们管理不同项目所需的Python环境，避免因为不同项目python包之间发生环境冲突问题。

!!! note 
    我们在做项目时要养成良好的习惯，不同的python项目要采取不同的虚拟环境，不同的虚拟环境之间要相互隔离，python版本和包均不共用

安装步骤: 
1. 从官方网站下载安装包: [官方网站](https://www.anaconda.com/download)
2. 运行安装包并选择安装路径(**记住路径，后面要用**)，等待安装完成。(要勾选**Add Anaconda to my PATH environment variable**)，虽然它显示建议你不要这么做，但是这样可以避免手动添加环境变量的麻烦。
3. 打开cmd输入conda回车，查看是否安装成功，如出现以下信息，则显示为安装成功
   
![](../img/01/1-1_01.png)

![](../img/01/1-1_02.png)

![](../img/01/1-1_03.png)

## 步骤2: CUDA与cuDNN的安装

桌面右键点进去NVIDIA控制面板，找到左下角的系统信息，点击组件，找到以下信息。

![](../img/01/1-1_04.png)

![](../img/01/1-1_05.png)

从NVCUDA64.DLL可以看到，我的电脑所支持的最高版本为12.0。

此时进入官网下载对应的CUDA: [官方网站](https://developer.nvidia.com/cuda-toolkit-archive)

![](../img/01/1-1_06.png)

根据自己电脑的支持版本下载对应的CUDA，下载完成后，在所在的文件夹下运行安装即可。查看是否安装成功，则打开cmd，输入nvcc -V，查看是否出现以下信息，有则代表安装成功。

![](../img/01/1-1_07.png)

然后安装相应版本的cuDNN: [官方网站](https://developer.nvidia.com/rdp/cudnn-archive)，选择相对应CUDA的版本下载。

![](../img/01/1-1_08.png)

![](../img/01/1-1_09.png)

下载完成后进行解压，得到一个CUDA文件夹，进入之后，全选文件，将其复制到之前的CUDA所安装的文件夹下，如果有重复替换即可。

查看cuDNN是否安装成功，如下图所述，进入这个路径输入bandwidthTest.exe，如果出现Result=PASS就代表安装成功。

![](../img/01/1-1_10.png)

紧接着执行deviceQuery.exe，如果出现Result=PASS，就代表CUDA和cuDNN都安装成功了。

![](../img/01/1-1_11.png)

### 步骤3: GPU版PyTorch安装

打开Anaconda Prompt，在开始菜单中搜索Anaconda

![](../img/01/1-1_12.png)

打开anaconda prompt后，是一个下图所示的界面

![](../img/01/1-1_13.png)

然后输入conda env list 

![](../img/01/1-1_14.png)

这条语句会显示出当前已存在的python虚拟环境，如果是刚安装anaconda，应该只有一个base基础环境。下面我们将新建立一个python虚拟环境，作为我们后续教程的基础。

```python
conda create -n clear python=3.9
```

这里python=xxx可以自己指定python版本，这里的clear是你所创建的虚拟环境的名称，大家可以自己取名。

然后激活环境，在anaconda prompt中输入：

```python
conda activate clear
```

此时我们可以发现(base)变为了(clear)，这说明了我们进入了clear这个虚拟环境

![](../img/01/1-1_15.png)

此时再进行安装python包就是在这个虚拟环境里操作，比如

```python
pip install numpy #或者conda install numpy
```

再输入
```python
conda list
```
![](../img/01/1-1_16.png)

我们可以看到此时在clear虚拟环境中就有了numpy这个包了

然后我们安装GPU版本的PyTorch，打开[官方网站](https://pytorch.org/)

![](../img/01/1-1_17.png)

选择复制Run this Command里的命令，在Anaconda Prompt中运行，最新的稳定版本需要python3.9及以上版本。

安装完成以后，查看PyTorch是否安装成功。

在Anaconda prompt中输入python，回车，然后输入下面内容
```python
import torch
print(torch.cuda.is_available())
```


![](../img/01/1-1_18.png)



